import{d as k,u as y,r,o as g,c as u,a as _,b as n,w as s,e as i,f as C,g as T}from"./index-DlJvQplD.js";const B={class:"mail"},D=["src"],E=k({__name:"MailListView",setup(V){const{axios:d}=y(),p=r([{text:"Action",value:"action"},{text:"Sender",value:"sender"},{text:"Title",value:"title"},{text:"Snippet",value:"snippet"},{text:"Date",value:"date"}]),l=r([]),m=r(null);async function v(o){return(await d.value.get(`/mails/${o}`)).data.data.mail}function x(o){const e=new Blob([o],{type:"text/html"});return URL.createObjectURL(e)}return g(async()=>{const o=await d.value.get("/mails/list"),{data:e}=o.data;l.value=e.mail_infos,m.value=e.next_page_token,l.value.map(t=>{v(t.id).then(a=>{t.sender=a.sender,t.title=a.title,t.date=a.date,t.detailMail=a}).catch(a=>{console.error(`Download mail id ${t.id} cause error`,a)})})}),(o,e)=>{const t=i("v-icon"),a=i("v-tooltip"),f=i("v-btn"),b=i("router-link"),h=i("EasyDataTable");return _(),u("div",B,[n(h,{style:{width:"100%"},headers:p.value,items:l.value},{"item-action":s(({detailMail:c})=>[n(b,{to:{name:"mail-fitting",params:{thread_id:c.id}},custom:""},{default:s(({navigate:w})=>[n(f,{icon:"",size:"x-small",onClick:w},{default:s(()=>[n(t,{icon:"$ai"}),n(a,{activator:"parent",location:"bottom"},{default:s(()=>e[0]||(e[0]=[T("Fitting By AI")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["to"])]),expand:s(({detailMail:c})=>[c.extracted_data?(_(),u("iframe",{key:0,src:x(c.extracted_data),width:"100%"},null,8,D)):C("",!0)]),_:1},8,["headers","items"])])}}});export{E as default};
