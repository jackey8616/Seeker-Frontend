import{d as T,u as B,a as V,r as l,o as A,c as m,b as d,e as i,w as n,f as c,g as p,h as u,t as v,i as E,j as L}from"./index-Cu85sX_Z.js";const N={class:"mail"},$=["src"],M=T({__name:"MailListView",setup(j){const f=B(),{axios:_}=V(),x=l([{text:"Action",value:"action"},{text:"Sender",value:"sender"},{text:"Title",value:"title"},{text:"Date",value:"date"}]),r=l([]),h=l(null);async function b(s){return(await _.value.get(`/mails/${s}`)).data.data.mail}function k(s){const e=new Blob([s],{type:"text/html"});return URL.createObjectURL(e)}return A(async()=>{const s=await _.value.get("/mails/list"),{data:e}=s.data;r.value=e.mail_infos,h.value=e.next_page_token,r.value.map(a=>{b(a.id).then(t=>{a.sender=t.sender,a.title=t.title,a.date=t.date,a.detailMail=t}).catch(t=>{console.error(`Download mail id ${a.id} cause error`,t)})})}),(s,e)=>{const a=c("v-icon"),t=c("v-tooltip"),y=c("v-btn"),w=c("router-link"),g=c("v-chip"),D=c("EasyDataTable");return d(),m("div",N,[i(D,{style:{width:"100%"},headers:x.value,items:r.value},{"item-action":n(({detailMail:o})=>[o!==void 0?(d(),L(w,{key:0,to:{name:"mail-fitting",params:{thread_id:o.id}},custom:""},{default:n(({navigate:C})=>[i(y,{icon:"",size:"x-small",onClick:C},{default:n(()=>[i(a,{icon:"$ai"}),i(t,{activator:"parent",location:"bottom"},{default:n(()=>e[0]||(e[0]=[u("Fitting By AI")])),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["to"])):p("",!0)]),"item-date":n(({date:o})=>[i(g,{size:"x-small"},{default:n(()=>[u(v(E(f).format(o,"keyboardDateTime24h"))+" ",1),i(t,{activator:"parent",location:"bottom"},{default:n(()=>[u(v(o),1)]),_:2},1024)]),_:2},1024)]),expand:n(({detailMail:o})=>[o.extracted_data?(d(),m("iframe",{key:0,src:k(o.extracted_data),width:"100%"},null,8,$)):p("",!0)]),_:1},8,["headers","items"])])}}});export{M as default};
