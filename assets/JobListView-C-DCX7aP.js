import{d as U,u as B,g as A,h as E,w as t,r as d,f as e,b as a,t as i,e as s,i as z,c as V,F,n as I,o as m,k as v,l as O,j as q,q as R}from"./index-DszUUmPU.js";const S={class:"d-flex gap-2"},G={class:"mb-4"},H={class:"mb-4"},K={class:"mb-4"},Q={key:0},W={class:"d-flex align-center mb-2"},X={style:{padding:"8px 0"}},Y={style:{"white-space":"pre-wrap","word-break":"break-word"}},Z={style:{padding:"8px 0"}},tt={style:{"white-space":"pre-wrap","word-break":"break-word"}},et={key:1,class:"text-center py-4 text-grey"},ot=U({__name:"JobDetailDialog",props:{modelValue:{type:Boolean},job:{}},emits:["update:modelValue"],setup(J,{emit:$}){const x=$,k=B();function g(){x("update:modelValue",!1)}return(n,o)=>{const c=d("v-icon"),y=d("v-tooltip"),f=d("v-btn"),w=d("v-card-title"),j=d("v-expansion-panel-title"),h=d("v-expansion-panel-text"),D=d("v-expansion-panel"),b=d("v-chip"),N=d("v-expansion-panels"),_=d("v-card-text"),l=d("v-card"),p=d("v-dialog");return n.job?(m(),A(p,{key:0,"model-value":n.modelValue,"onUpdate:modelValue":o[0]||(o[0]=u=>x("update:modelValue",u)),"max-width":"800px",persistent:"",transition:"dialog-bottom-transition","retain-focus":!1,"onClick:outside":g},{default:t(()=>[e(l,null,{default:t(()=>[e(w,{class:"d-flex justify-space-between align-center"},{default:t(()=>[a("span",null,i(n.job.title),1),a("div",S,[e(f,{icon:"",href:n.job.url,target:"_blank",rel:"noopener noreferrer"},{default:t(()=>[e(c,null,{default:t(()=>o[1]||(o[1]=[s("mdi-open-in-new")])),_:1}),e(y,{activator:"parent",location:"bottom"},{default:t(()=>o[2]||(o[2]=[s("Open in new tab")])),_:1})]),_:1},8,["href"]),e(f,{icon:"",onClick:g},{default:t(()=>[e(c,null,{default:t(()=>o[3]||(o[3]=[s("mdi-close")])),_:1})]),_:1})])]),_:1}),e(_,null,{default:t(()=>[a("div",G,[o[4]||(o[4]=a("strong",null,"Domain:",-1)),s(" "+i(n.job.domain),1)]),a("div",H,[o[5]||(o[5]=a("strong",null,"Created At:",-1)),s(" "+i(z(k).format(n.job.created_at,"keyboardDateTime24h")),1)]),a("div",K,[o[6]||(o[6]=a("strong",null,"Updated At:",-1)),s(" "+i(n.job.updated_at?z(k).format(n.job.updated_at,"keyboardDateTime24h"):"N/A"),1)]),e(N,null,{default:t(()=>[e(D,null,{default:t(()=>[e(j,null,{default:t(()=>o[7]||(o[7]=[a("strong",null,"Description",-1)])),_:1}),e(h,null,{default:t(()=>[s(i(n.job.description||"No description available"),1)]),_:1})]),_:1}),e(D,null,{default:t(()=>[e(j,null,{actions:t(()=>[e(b,{size:"small",class:"ml-2"},{default:t(()=>{var u;return[s(i(((u=n.job.chat_logs)==null?void 0:u.length)||0)+" conversations",1)]}),_:1})]),default:t(()=>[o[8]||(o[8]=a("strong",null,"Chat Logs",-1))]),_:1}),e(h,null,{default:t(()=>[n.job.chat_logs&&n.job.chat_logs.length>0?(m(),V("div",Q,[(m(!0),V(F,null,I(n.job.chat_logs,(u,C)=>(m(),V("div",{key:C,style:{border:"1px solid #e0e0e0","border-radius":"8px",padding:"16px","margin-bottom":"16px"}},[a("div",W,[e(b,{size:"small",color:"primary",class:"mr-2"},{default:t(()=>[s(i(z(k).format(u.start_datetime,"keyboardDateTime24h")),1)]),_:2},1024),e(b,{size:"small",variant:"outlined"},{default:t(()=>[s(i(u.input_token+u.output_token)+" tokens ",1)]),_:2},1024)]),a("div",X,[o[9]||(o[9]=a("div",{class:"text-subtitle-2 mb-1"},"Input:",-1)),a("div",Y,i(u.input),1)]),a("div",Z,[o[10]||(o[10]=a("div",{class:"text-subtitle-2 mb-1"},"Output:",-1)),a("div",tt,i(u.output),1)])]))),128))])):(m(),V("div",et,[e(c,{size:"large",class:"mb-2"},{default:t(()=>o[11]||(o[11]=[s("mdi-chat-outline")])),_:1}),o[12]||(o[12]=a("div",null,"No chat logs available",-1))]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):E("",!0)}}}),at={class:"font-weight-medium"},lt={class:"text-caption text-truncate",style:{"max-width":"300px"}},nt={class:"d-flex flex-column align-center pa-4"},st={class:"d-flex align-center justify-space-between pa-4"},it={class:"d-flex align-center gap-2"},dt={class:"text-caption"},rt={class:"text-caption"},ut={class:"d-flex align-center gap-1"},_t=U({__name:"JobListView",setup(J){const $=q("apiClient"),x=B();R();const k=v([{title:"Action",text:"Action",value:"action",sortable:!1,width:"60px"},{title:"Domain",text:"Domain",value:"domain",width:"120px"},{title:"Title",text:"Title",value:"title"},{title:"CreatedAt",text:"CreateTime",value:"created_at",sortable:!0,width:"180px"},{title:"UpdatedAt",text:"UpdateTime",value:"updated_at",sortable:!0,width:"180px"}]);v([{key:"updated_at",order:"desc"}]);const g=v([]),n=v(1),o=v(),c=v(),y=v(!0),f=v(100),w=v(!1),j=v(null),h=v(20);async function D(_=1){y.value=!0;const l=_==1?{}:{page_token:_>n.value?c.value:o.value};try{const{data:p}=await $.client.post("/jobs",l).then(({data:u})=>u);g.value=p.jobs,o.value=p.cursor.previous_page_token,c.value=p.cursor.next_page_token,n.value=_,f.value=Math.max(100,g.value.length*5)}catch(p){console.error("Error fetching jobs:",p)}finally{y.value=!1}}async function b(_){const l=_.page||1;await D(l)}function N(_){j.value=_,w.value=!0}return O(async()=>{await D(1)}),(_,l)=>{const p=d("v-icon"),u=d("v-tooltip"),C=d("v-btn"),T=d("v-chip"),L=d("v-skeleton-loader"),P=d("v-divider"),M=d("v-data-table-server");return m(),V("div",null,[e(M,{headers:k.value,items:g.value,"items-length":f.value,loading:y.value,"items-per-page":"20","onUpdate:options":b,class:"elevation-1","hide-default-footer":""},{"item.action":t(({item:r})=>[e(C,{icon:"",size:"small",onClick:pt=>N(r)},{default:t(()=>[e(p,null,{default:t(()=>l[3]||(l[3]=[s("mdi-eye")])),_:1}),e(u,{activator:"parent",location:"bottom"},{default:t(()=>l[4]||(l[4]=[s("View Details")])),_:1})]),_:2},1032,["onClick"])]),"item.domain":t(({item:r})=>[e(T,{size:"small"},{default:t(()=>[s(i(r.domain),1)]),_:2},1024)]),"item.title":t(({item:r})=>[a("div",at,i(r.title),1),a("div",lt,i(r.description||"No description"),1)]),"item.created_at":t(({item:r})=>[e(T,{size:"small",variant:"outlined",class:"text-caption"},{default:t(()=>[s(i(z(x).format(r.created_at,"keyboardDateTime24h"))+" ",1),e(u,{activator:"parent",location:"bottom"},{default:t(()=>[s(i(r.created_at),1)]),_:2},1024)]),_:2},1024)]),"item.updated_at":t(({item:r})=>[r.updated_at?(m(),A(T,{key:0,size:"small",variant:"outlined",class:"text-caption"},{default:t(()=>[s(i(z(x).format(r.updated_at,"keyboardDateTime24h"))+" ",1),e(u,{activator:"parent",location:"bottom"},{default:t(()=>[s(i(r.updated_at),1)]),_:2},1024)]),_:2},1024)):(m(),A(T,{key:1,size:"small",variant:"outlined",color:"grey"},{default:t(()=>l[5]||(l[5]=[s("N/A")])),_:1}))]),"no-data":t(()=>[a("div",nt,[e(p,{size:"large",color:"grey",class:"mb-2"},{default:t(()=>l[6]||(l[6]=[s("mdi-alert-circle-outline")])),_:1}),l[7]||(l[7]=a("span",{class:"text-grey"},"No jobs found",-1))])]),loading:t(()=>[e(L,{type:"table-row@6"})]),bottom:t(()=>[a("div",st,[a("div",it,[a("div",dt,i((n.value-1)*h.value+1)+"-"+i(Math.min(n.value*h.value,f.value))+" of "+i(f.value),1),e(P,{vertical:"",class:"mx-2"}),a("div",rt," Page "+i(n.value),1)]),a("div",ut,[e(C,{icon:"",size:"small",variant:"text",disabled:n.value===1,onClick:l[0]||(l[0]=r=>b({page:n.value-1}))},{default:t(()=>[e(p,null,{default:t(()=>l[8]||(l[8]=[s("mdi-chevron-left")])),_:1})]),_:1},8,["disabled"]),e(C,{icon:"",size:"small",variant:"text",disabled:!c.value,onClick:l[1]||(l[1]=r=>b({page:n.value+1}))},{default:t(()=>[e(p,null,{default:t(()=>l[9]||(l[9]=[s("mdi-chevron-right")])),_:1})]),_:1},8,["disabled"])])])]),_:1},8,["headers","items","items-length","loading"]),e(ot,{modelValue:w.value,"onUpdate:modelValue":l[2]||(l[2]=r=>w.value=r),job:j.value},null,8,["modelValue","job"])])}}});export{_t as default};
