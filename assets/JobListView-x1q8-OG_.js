import{_ as R}from"./ChatLogDetail.vue_vue_type_script_setup_true_lang-zuyMhcR0.js";import{d as E,u as P,k as L,l as O,w as t,r as i,f as e,b as n,t as d,e as l,n as N,c as U,F as q,m as G,o as f,g as p,h as H,i as K}from"./index-CGjNS5Fa.js";const Q={class:"d-flex gap-2"},W={class:"mb-4"},X={class:"mb-4"},Y={class:"mb-4"},Z={key:0},tt={key:1,class:"text-center py-4 text-grey"},et=E({__name:"JobDetailDialog",props:{modelValue:{type:Boolean},job:{}},emits:["update:modelValue"],setup(S,{emit:$}){const k=$,m=P();function _(){k("update:modelValue",!1)}return(r,a)=>{const u=i("v-icon"),j=i("v-tooltip"),b=i("v-btn"),w=i("router-link"),g=i("v-card-title"),x=i("v-expansion-panel-title"),h=i("v-expansion-panel-text"),C=i("v-expansion-panel"),V=i("v-chip"),D=i("v-expansion-panels"),A=i("v-card-text"),B=i("v-card"),v=i("v-dialog");return r.job?(f(),L(v,{key:0,"model-value":r.modelValue,"onUpdate:modelValue":a[0]||(a[0]=o=>k("update:modelValue",o)),"max-width":"800px",persistent:"",transition:"dialog-bottom-transition","retain-focus":!1,"onClick:outside":_},{default:t(()=>[e(B,null,{default:t(()=>[e(g,{class:"d-flex justify-space-between align-center"},{default:t(()=>[n("span",null,d(r.job.title),1),n("div",Q,[e(w,{to:{name:"job-fitting",params:{job_id:r.job.id}},custom:""},{default:t(({navigate:o})=>[e(b,{icon:"",onClick:o},{default:t(()=>[e(u,{icon:"mdi-brain"}),e(j,{activator:"parent",location:"bottom"},{default:t(()=>a[1]||(a[1]=[l("Fitting By AI")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["to"]),e(b,{icon:"",href:r.job.url,target:"_blank",rel:"noopener noreferrer"},{default:t(()=>[e(u,null,{default:t(()=>a[2]||(a[2]=[l("mdi-open-in-new")])),_:1}),e(j,{activator:"parent",location:"bottom"},{default:t(()=>a[3]||(a[3]=[l("Open in new tab")])),_:1})]),_:1},8,["href"]),e(b,{icon:"",onClick:_},{default:t(()=>[e(u,null,{default:t(()=>a[4]||(a[4]=[l("mdi-close")])),_:1})]),_:1})])]),_:1}),e(A,null,{default:t(()=>[n("div",W,[a[5]||(a[5]=n("strong",null,"Domain:",-1)),l(" "+d(r.job.domain),1)]),n("div",X,[a[6]||(a[6]=n("strong",null,"Created At:",-1)),l(" "+d(N(m).format(r.job.created_at,"keyboardDateTime24h")),1)]),n("div",Y,[a[7]||(a[7]=n("strong",null,"Updated At:",-1)),l(" "+d(r.job.updated_at?N(m).format(r.job.updated_at,"keyboardDateTime24h"):"N/A"),1)]),e(D,null,{default:t(()=>[e(C,null,{default:t(()=>[e(x,null,{default:t(()=>a[8]||(a[8]=[n("strong",null,"Description",-1)])),_:1}),e(h,null,{default:t(()=>[l(d(r.job.description||"No description available"),1)]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(x,null,{actions:t(()=>[e(V,{size:"small",class:"ml-2"},{default:t(()=>{var o;return[l(d(((o=r.job.chat_logs)==null?void 0:o.length)||0)+" conversations",1)]}),_:1})]),default:t(()=>[a[9]||(a[9]=n("strong",null,"Chat Logs",-1))]),_:1}),e(h,null,{default:t(()=>[r.job.chat_logs&&r.job.chat_logs.length>0?(f(),U("div",Z,[(f(!0),U(q,null,G(r.job.chat_logs,(o,T)=>(f(),U("div",{key:T,style:{border:"1px solid #e0e0e0","border-radius":"8px",padding:"16px","margin-bottom":"16px"}},[e(R,{chat:o},null,8,["chat"])]))),128))])):(f(),U("div",tt,[e(u,{size:"large",class:"mb-2"},{default:t(()=>a[10]||(a[10]=[l("mdi-chat-outline")])),_:1}),a[11]||(a[11]=n("div",null,"No chat logs available",-1))]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"])):O("",!0)}}}),ot={class:"d-flex align-center gap-2 mb-4"},at={class:"d-flex gap-1"},lt={class:"font-weight-medium"},nt={class:"text-caption text-truncate",style:{"max-width":"300px"}},it={class:"d-flex flex-column align-center pa-4"},st={class:"d-flex align-center justify-space-between pa-4"},dt={class:"d-flex align-center gap-2"},rt={class:"text-caption"},ut={class:"text-caption"},pt={class:"d-flex align-center gap-1"},_t=E({__name:"JobListView",setup(S){const $=K("apiClient"),k=P(),m=p(""),_=p(!1),r=p([{title:"Action",text:"Action",value:"action",sortable:!1,width:"60px"},{title:"Domain",text:"Domain",value:"domain",width:"120px"},{title:"Title",text:"Title",value:"title"},{title:"CreatedAt",text:"CreateTime",value:"created_at",sortable:!0,width:"180px"},{title:"UpdatedAt",text:"UpdateTime",value:"updated_at",sortable:!0,width:"180px"}]);p([{key:"updated_at",order:"desc"}]);const a=p([]),u=p(1),j=p(),b=p(),w=p(!0),g=p(100),x=p(!1),h=p(null),C=p(20);async function V(v=1,o=!0){o&&(w.value=!0);const T=v==1?{}:{page_token:v>u.value?b.value:j.value};try{const{data:c}=await $.client.post("/jobs",T).then(({data:y})=>y);a.value=c.jobs,j.value=c.cursor.previous_page_token,b.value=c.cursor.next_page_token,u.value=v,g.value=Math.max(100,a.value.length*5)}catch(c){console.error("Error fetching jobs:",c)}finally{o&&(w.value=!1)}}async function D(v){const o=v.page||1;await V(o)}function A(v){h.value=v,x.value=!0}async function B(){if(m.value){_.value=!0;try{await $.client.post("/jobs/crawl",{url:m.value}),m.value="",V(1,!1)}catch(v){console.error("Error submitting URL:",v)}finally{_.value=!1}}}return H(async()=>{await V(1)}),(v,o)=>{const T=i("v-text-field"),c=i("v-btn"),y=i("v-icon"),J=i("v-tooltip"),z=i("v-chip"),F=i("v-skeleton-loader"),I=i("v-divider"),M=i("v-data-table-server");return f(),U("div",null,[n("div",ot,[e(T,{modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=s=>m.value=s),label:"Enter URL to add a Job",placeholder:"https://example.com","hide-details":"",class:"flex-grow-1",disabled:_.value},null,8,["modelValue","disabled"]),e(c,{color:"primary",loading:_.value,disabled:!m.value||_.value,onClick:B},{default:t(()=>o[4]||(o[4]=[l(" Submit ")])),_:1},8,["loading","disabled"])]),e(M,{headers:r.value,items:a.value,"items-length":g.value,loading:w.value,"items-per-page":"20","onUpdate:options":D,class:"elevation-1","hide-default-footer":""},{"item.action":t(({item:s})=>[n("div",at,[e(c,{icon:"",size:"small",onClick:vt=>A(s)},{default:t(()=>[e(y,null,{default:t(()=>o[5]||(o[5]=[l("mdi-eye")])),_:1}),e(J,{activator:"parent",location:"bottom"},{default:t(()=>o[6]||(o[6]=[l("View Details")])),_:1})]),_:2},1032,["onClick"])])]),"item.domain":t(({item:s})=>[e(z,{size:"small"},{default:t(()=>[l(d(s.domain),1)]),_:2},1024)]),"item.title":t(({item:s})=>[n("div",lt,d(s.title),1),n("div",nt,d(s.description||"No description"),1)]),"item.created_at":t(({item:s})=>[e(z,{size:"small",variant:"outlined",class:"text-caption"},{default:t(()=>[l(d(N(k).format(s.created_at,"keyboardDateTime24h"))+" ",1),e(J,{activator:"parent",location:"bottom"},{default:t(()=>[l(d(s.created_at),1)]),_:2},1024)]),_:2},1024)]),"item.updated_at":t(({item:s})=>[s.updated_at?(f(),L(z,{key:0,size:"small",variant:"outlined",class:"text-caption"},{default:t(()=>[l(d(N(k).format(s.updated_at,"keyboardDateTime24h"))+" ",1),e(J,{activator:"parent",location:"bottom"},{default:t(()=>[l(d(s.updated_at),1)]),_:2},1024)]),_:2},1024)):(f(),L(z,{key:1,size:"small",variant:"outlined",color:"grey"},{default:t(()=>o[7]||(o[7]=[l("N/A")])),_:1}))]),"no-data":t(()=>[n("div",it,[e(y,{size:"large",color:"grey",class:"mb-2"},{default:t(()=>o[8]||(o[8]=[l("mdi-alert-circle-outline")])),_:1}),o[9]||(o[9]=n("span",{class:"text-grey"},"No jobs found",-1))])]),loading:t(()=>[e(F,{type:"table-row@6"})]),bottom:t(()=>[n("div",st,[n("div",dt,[n("div",rt,d((u.value-1)*C.value+1)+"-"+d(Math.min(u.value*C.value,g.value))+" of "+d(g.value),1),e(I,{vertical:"",class:"mx-2"}),n("div",ut," Page "+d(u.value),1)]),n("div",pt,[e(c,{icon:"",size:"small",variant:"text",disabled:u.value===1,onClick:o[1]||(o[1]=s=>D({page:u.value-1}))},{default:t(()=>[e(y,null,{default:t(()=>o[10]||(o[10]=[l("mdi-chevron-left")])),_:1})]),_:1},8,["disabled"]),e(c,{icon:"",size:"small",variant:"text",disabled:!b.value,onClick:o[2]||(o[2]=s=>D({page:u.value+1}))},{default:t(()=>[e(y,null,{default:t(()=>o[11]||(o[11]=[l("mdi-chevron-right")])),_:1})]),_:1},8,["disabled"])])])]),_:1},8,["headers","items","items-length","loading"]),e(et,{modelValue:x.value,"onUpdate:modelValue":o[3]||(o[3]=s=>x.value=s),job:h.value},null,8,["modelValue","job"])])}}});export{_t as default};
