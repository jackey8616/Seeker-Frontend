import{d as f,u as b,r,o as w,a as i,c as l,b as d,e as u,w as _,f as k,g as y}from"./index-CT5s9tZp.js";const g={class:"mail"},C=["onClick"],B=["src"],V=f({__name:"MailListView",setup(D){const{axios:c}=b(),p=r([{text:"Sender",value:"sender"},{text:"Title",value:"title"},{text:"Snippet",value:"snippet"},{text:"Date",value:"date"}]),s=r([]),m=r(null);async function h(a){return(await c.value.get(`/mails/${a}`)).data.data.mail}function x(a){const n=new Blob([a],{type:"text/html"});return URL.createObjectURL(n)}return w(async()=>{const a=await c.value.get("/mails/list"),{data:n}=a.data;s.value=n.mail_infos,m.value=n.next_page_token,s.value.map(e=>{h(e.id).then(t=>{e.sender=t.sender,e.title=t.title,e.date=t.date,e.detailMail=t}).catch(t=>{console.error(`Download mail id ${e.id} cause error`,t)})})}),(a,n)=>{const e=i("router-link"),t=i("EasyDataTable");return d(),l("div",g,[u(t,{style:{width:"100%"},headers:p.value,items:s.value},{expand:_(({detailMail:o})=>[u(e,{to:{name:"mail-fitting",params:{thread_id:o.id}},custom:""},{default:_(({navigate:v})=>[y("button",{onClick:v},"Fitting by AI",8,C)]),_:2},1032,["to"]),o.extracted_data?(d(),l("iframe",{key:0,src:x(o.extracted_data),width:"100%"},null,8,B)):k("",!0)]),_:1},8,["headers","items"])])}}});export{V as default};
